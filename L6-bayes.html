<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STAT 117: Data Analysis in Modern Biostatistics – l6-bayes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STAT 117: Data Analysis in Modern Biostatistics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lectures" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Lectures</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lectures">    
        <li>
    <a class="dropdown-item" href="./L1-intro.html" rel="" target="">
 <span class="dropdown-text">Lecture 1 Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L2-biomarkers.html" rel="" target="">
 <span class="dropdown-text">Lecture 2: Cancer Biomarkers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L3-data.html" rel="" target="">
 <span class="dropdown-text">Lecture 3: Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L4-metrics.html" rel="" target="">
 <span class="dropdown-text">Lecture 4: Basics of Biomarker Evaluation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L5-decision.html" rel="" target="">
 <span class="dropdown-text">Lecture 5 (February 7, 2023) Decision Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L6-bayes.html" rel="" target="">
 <span class="dropdown-text">Lecture 6 (February 9, 2023) Bayesian Modeling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L7-mcmc.html" rel="" target="">
 <span class="dropdown-text">Lecture 7 (February 14, 2023) Monte Carlo Markov Chains</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L8-timetoevent.html" rel="" target="">
 <span class="dropdown-text">Lecture 8 (February 16, 2023) Time to Event Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L9-comparing.html" rel="" target="">
 <span class="dropdown-text">Lecture 9 (February 21, 2023) Comparing Criteria for Biomarker Discovery</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L10-fdr.html" rel="" target="">
 <span class="dropdown-text">Lecture 10 (February 28, 2023) False Discovery Rates</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L11-regmean.html" rel="" target="">
 <span class="dropdown-text">Lecture 11: Regression to the Mean</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L12-shrinkage.html" rel="" target="">
 <span class="dropdown-text">Lecture 12: Shrinkage</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./L14-shrinkage2.html" rel="" target="">
 <span class="dropdown-text">Lecture 14 (March 21, 2023) Shrinkage part 2</span></a>
  </li>  
        <li class="dropdown-header">L15-metaanlysis2.qmd</li>
        <li>
    <a class="dropdown-item" href="./L17-twomarkers.html" rel="" target="">
 <span class="dropdown-text">Lecture 17 (March 29, 2023)</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#lecture-6-february-9-2023-bayesian-modeling" id="toc-lecture-6-february-9-2023-bayesian-modeling" class="nav-link active" data-scroll-target="#lecture-6-february-9-2023-bayesian-modeling">Lecture 6 (February 9, 2023) Bayesian Modeling</a>
  <ul class="collapse">
  <li><a href="#bayesian-models" id="toc-bayesian-models" class="nav-link" data-scroll-target="#bayesian-models">Bayesian Models</a>
  <ul class="collapse">
  <li><a href="#bayes-rule" id="toc-bayes-rule" class="nav-link" data-scroll-target="#bayes-rule">Bayes Rule</a></li>
  </ul></li>
  <li><a href="#inference-on-sensitivity-and-specificity" id="toc-inference-on-sensitivity-and-specificity" class="nav-link" data-scroll-target="#inference-on-sensitivity-and-specificity">Inference on Sensitivity and Specificity</a>
  <ul class="collapse">
  <li><a href="#likelihood-case-control-design" id="toc-likelihood-case-control-design" class="nav-link" data-scroll-target="#likelihood-case-control-design">Likelihood Case Control Design</a></li>
  <li><a href="#likelihood-for-population-based-design" id="toc-likelihood-for-population-based-design" class="nav-link" data-scroll-target="#likelihood-for-population-based-design">Likelihood for Population-Based Design</a></li>
  <li><a href="#posterior-inference" id="toc-posterior-inference" class="nav-link" data-scroll-target="#posterior-inference">Posterior Inference</a></li>
  <li><a href="#prediction-of-future-observations" id="toc-prediction-of-future-observations" class="nav-link" data-scroll-target="#prediction-of-future-observations">Prediction of Future Observations</a></li>
  </ul></li>
  <li><a href="#likelihood-principle" id="toc-likelihood-principle" class="nav-link" data-scroll-target="#likelihood-principle">Likelihood Principle</a></li>
  <li><a href="#monte-carlo-explorations-of-posterior-distributions" id="toc-monte-carlo-explorations-of-posterior-distributions" class="nav-link" data-scroll-target="#monte-carlo-explorations-of-posterior-distributions">Monte Carlo Explorations of Posterior Distributions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<div style="page-break-after: always;"></div>
<section id="lecture-6-february-9-2023-bayesian-modeling" class="level1">
<h1>Lecture 6 (February 9, 2023) Bayesian Modeling</h1>
<section id="bayesian-models" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-models">Bayesian Models</h2>
<p>So far we focused on statistical summaries, but have paid little attention to uncertainty about them. When we say that the PPV at a level of -1 for ZNF487 expression is .2, how sure are we? When we look at the comparison between the PR curves or benefit curves of two biomarkers, how reliably can we say that one is above the other? We are going to approach these questions using Bayesian models. Both “Bayesian” and “model” are very loaded words. We could go w/out models at all and rely on resampling techniques like the bootstrap to generate uncertainty statements. Or we could specify models, but use non-Bayesian methods, such as maximum likelihood, for our uncertainty. There are pros and cons of each of these choices. Models are powerful and can amplify the value of your data if you get them approximately right (a nontrivial task). Bayes is powerful, general and simple in concept, but a bit high maintenance compared to its frequentist counterparts. There are cool model-free or model-robust Bayesian techniques, but we will only scratch the surface there.</p>
<p>If you are completely new to Bayesian learning, here is <a href="https://willhipson.netlify.app/post/bayesian_intro/binomial_gold/">a gentle introduction with a cute animation</a> and here is <a href="https://www.bayesrulesbook.com/chapter-3.html">the Bayesrulesbook chapter on the Beta-Binomial case</a>. You will not find it hard to scout material at the right level for you online. “Modeling in Medical Decision Making” has relevant chapters. I posted a copy on the canvas files. A great reference is <a href=""><span class="citation" data-cites="Hoff2009">@Hoff2009</span></a> A fun book, though perhaps way more than you signed up for, is <span class="citation" data-cites="mcelreath2020">[@mcelreath2020]</span>. <a href="http://dx.doi.org/10.1145/3313831.3376377"><span class="citation" data-cites="sarma2020chi">@sarma2020chi</span></a> offers a brief review on how to think about, and specify, prior distributions, often a sticky points for Bayesian analysis.</p>
<p>Bayesian learning uses probability to represent both variation / randomness in the real world, and incomplete knowledge. As a result, probabilities provide a selef contained system that formally represents knowledge in the face of uncertainty and can be used to update knowledge when new information is introduced. In general, we typically wish to understand characteristics that govern a population, from which we normally have a subset of data representing it. Population quantities capturing these characteristics are usually represented in terms of a parameter <span class="math inline">\(\theta\)</span>. The subset of data is represented through variables <span class="math inline">\(x,y\)</span>.</p>
<div style="page-break-after: always;"></div>
<section id="bayes-rule" class="level3">
<h3 class="anchored" data-anchor-id="bayes-rule">Bayes Rule</h3>
<p>The following equation represents the basis of Bayesian modeling.</p>
<span class="math display">\[\begin{equation}
\begin{split}
P(\theta | x,y) &amp;= \frac{P(x,y | \theta) P(\theta)}{\int_\theta P(x,y | \theta) P(\theta)d\theta} = \frac{P(x,y | \theta) P(\theta)}{P(x,y)}\propto P(x,y | \theta) P(\theta)
\end{split}
\end{equation}\]</span>
<p>Likelihood: <span class="math inline">\(P(x,y | \theta)\)</span></p>
<p>Prior: <span class="math inline">\(P(\theta)\)</span></p>
<p>Posterior: <span class="math inline">\(P(\theta | x,y)\)</span></p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="inference-on-sensitivity-and-specificity" class="level2">
<h2 class="anchored" data-anchor-id="inference-on-sensitivity-and-specificity">Inference on Sensitivity and Specificity</h2>
<section id="likelihood-case-control-design" class="level3">
<h3 class="anchored" data-anchor-id="likelihood-case-control-design">Likelihood Case Control Design</h3>
<p>We now focus, to begin, on a case-control example to evaluate a dichotomous biomarker. In this example, we assume that we know whether patients have a disease or not, which we represent with <span class="math inline">\(y=1\)</span> for a disease case, and <span class="math inline">\(y=0\)</span> for a non-disease case. Furthermore, we know the biomarker level of each patient, which is represented as <span class="math inline">\(x=1\)</span> if they have, say, a high level of expression, and a <span class="math inline">\(x=0\)</span> for a low level of expression. The following <span class="math inline">\(2 \times 2\)</span> table represents such a scenario.</p>
<p>Here <span class="math inline">\(m_0\)</span> and <span class="math inline">\(m_1\)</span> represent the number of patients with no disease and a high biomarker, and the number of patients with disease and a high biomarker, respectively. The total counts for the margins for <span class="math inline">\(y\)</span> (<span class="math inline">\(n_0\)</span> and <span class="math inline">\(n_1\)</span>) are fixed.</p>
<p>In such a set-up, the parameters of interest would usually then be the , denoted as</p>
<p><span class="math display">\[
\beta = p(x=1\mid y=1)
\]</span></p>
<p>and ,</p>
<p><span class="math display">\[
\alpha = p(x=0|y=0)
\]</span></p>
<p>The likelihood for learning about sensitivity and specificity from the observed data would then be,</p>
<p><span class="math display">\[
L_{CC} = \binom{n_1}{m_1} \beta^{m_1}\left(1-\beta\right)^{n_1-m_1}\binom{n_0}{m_0}\left(1-\alpha\right)^{m_0}\alpha^{n_0-m_0}
\]</span> </p>
</section>
<section id="likelihood-for-population-based-design" class="level3">
<h3 class="anchored" data-anchor-id="likelihood-for-population-based-design">Likelihood for Population-Based Design</h3>
<p>We note that such a construct assumes ahead of time that the total number of disease and disease-free individuals are fixed. This may be too restrictive in some settings. Therefore, we may alternatively fix the sample size instead, so that <span class="math inline">\(n_0\)</span> and <span class="math inline">\(n_1\)</span> may vary as long as their sum is equal to a fixed <span class="math inline">\(n = n_0 + n_1\)</span>. Such a model, which we refer to as “population based”, would allow more flexibility and implies the following table.</p>
<p>The parameters associated with this table include the sensitivity and prevalence, <span class="math inline">\(\alpha, \beta\)</span> from before, in addition to the , represented as,</p>
<p><span class="math display">\[
\pi = p(y=1)
\]</span></p>
<p>The table may be rewritten in terms of these three parameters as a table of proportions, given by</p>
<p>Then the associated likelihood function can be represented in terms of the case control likelihood as,</p>
<p><span class="math display">\[
L_{PB} = \binom{n_0+n_1}{n_1}\pi^{n_1}\left(1-\pi\right)^{n_0}\cdot L_{CC}
\]</span></p>
<p>This model allows for the observation of a different number of disease and no disease cases conditional on a fixed total sample size. The prevalence can then be estimated under such a model, which we note takes a binomial mass function form through the likelihood above.</p>
</section>
<section id="posterior-inference" class="level3">
<h3 class="anchored" data-anchor-id="posterior-inference">Posterior Inference</h3>
<p>The likelihood function we have specified under both models can then be incorporated into a Bayesian model. Specifically, we may conduct Bayesian inference on the parameters of interest. Under the case control example, one idea may be to specify a uniform prior on both the parameters for specificity and sensitivity, <span class="math inline">\(\alpha, \beta\)</span>. The prior is given as,</p>
<p><span class="math display">\[
P(\alpha,\beta) = 1, \ \ \text{for} \ \ \alpha \in [0,1], \beta \in [0,1]
\]</span></p>
<p>which when combined with the likelihood <span class="math inline">\(L_{CC}\)</span> yields the posterior of the form,</p>
<p><span class="math display">\[
P(\alpha,\beta|m_0,m_1) \propto
1 \times \binom{n_1}{m_1} \beta^{m_1} ( 1-\beta) ^{n_1-m_1}
\binom{n_0}{m_0} (1-\alpha)^{m_0} \alpha ^{n_0-m_0}
\]</span> The uniform prior places equal mass on the possible support for <span class="math inline">\(\alpha,\beta\)</span>. One can recognize that the kernel of the posterior is consistent with that of a Beta distribution and therefore the normalizing constants can be easily derived. If instead we had prior information regarding <span class="math inline">\(\alpha,\beta\)</span>, we may instead model them each as a Beta distribution. Such a prior will jointly be,</p>
<p><span class="math display">\[
P(\alpha,\beta) =\frac{\Gamma(b_0+b_1)}{\Gamma(b_1)\Gamma(b_0)}\beta^{b_1-1}(1-\beta)^{b_0-1}\frac{\Gamma(a_0+a_1)}{\Gamma(a_1)\Gamma(a_0)}(1-\alpha)^{a_1-1}\alpha^{a_0-1}
\]</span></p>
<p>which when combined with the likelihood <span class="math inline">\(L_{CC}\)</span> will result in the posterior form,</p>
<p><span class="math display">\[
P(\alpha,\beta|m_0,m_1) \propto \beta^{m_1+b_1-1} ( 1-\beta) ^{n_1-m_1 + b_0-1}(1-\alpha)^{m_0 + a_1-1} \alpha ^{n_0-m_0+a_0-1}
\]</span></p>
<p>For the population based set-up, where we only fixed the total number of sample cases, we may put Beta priors on each of the three parameters of interest, <span class="math inline">\(\alpha, \beta, \pi\)</span>. The prior will then be with the form,</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
P(\alpha,\beta,\pi) &amp; = \frac{\Gamma(p_0+p_1)}{\Gamma(p_1)\Gamma(p_0)}\pi^{p_1-1}(1-\pi)^{p_0-1}\
\times \\
&amp;  \frac{\Gamma(b_0+b_1)}{\Gamma(b_1)\Gamma(b_0)}\beta^{b_1-1}(1-\beta)^{b_0-1}\frac{\Gamma(a_0+a_1)}{\Gamma(a_1)\Gamma(a_0)}(1-\alpha)^{a_1-1}\alpha^{a_0-1}
\end{split}
\end{equation}\]</span>\end{equation}\end{equation}\end{equation}\end{equation}</p>
<p>which leads to a posterior of the form,</p>
<span class="math display">\[\begin{equation}
\begin{split}
P(\alpha,\beta, \pi|m_0,m_1) &amp; \propto \pi^{n_1+p_1-1} ( 1-\pi) ^{n_0+p_0-1} \\
&amp; \beta^{m_1+b_1-1} ( 1-\beta) ^{n_1-m_1 + b_0-1}(1-\alpha)^{m_0 + a_1-1} \alpha ^{n_0-m_0+a_0-1}
\end{split}
\end{equation}\]</span>
<div style="page-break-after: always;"></div>
</section>
<section id="prediction-of-future-observations" class="level3">
<h3 class="anchored" data-anchor-id="prediction-of-future-observations">Prediction of Future Observations</h3>
<p>Now suppose that we wanted to predict a future outcome <span class="math inline">\(y^*\)</span> for a subject with a biomarker level of <span class="math inline">\(x^*\)</span>. Then, the is given by,</p>
<span class="math display">\[\begin{equation}
\begin{split}
P(y^*|x^*) &amp;= \int_{\theta} P(y^* | x^*, \theta) P(\theta)d\theta \\
= \int_{\theta} \dfrac{P(y^*,x^*| \theta)}{P(x^*| \theta)} P(\theta)d\theta
\end{split}
\end{equation}\]</span>
<p>The prior predictive may be thought of as the data marginalized over the prior distribution, or the predictied value of a new data point before observing the actual sample itself. Related to this is the , which is interpreted as the predicted value of a new data point after observing the sample data. The posterior predictive is given by,</p>
<p><span class="math display">\[
P(y^*|x^*, y, x) =\int_{\theta} P(y^* | x^*, \theta) P(\theta|y, x)d\theta
\]</span></p>
</section>
</section>
<section id="likelihood-principle" class="level2">
<h2 class="anchored" data-anchor-id="likelihood-principle">Likelihood Principle</h2>
<p>Related to the above is the .</p>
<div style="page-break-after: always;"></div>
<p>For example, two experiments to assess a proportion <span class="math inline">\(\theta\)</span></p>
<p>We can illustrate the above principle using an example. Using the two experiments on the previous page, we would like to evaluate</p>
<p>Different sampling models may result in different p-values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">3</span>, <span class="dv">12</span>, <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07299805</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pnbinom</span>(<span class="dv">8</span>, <span class="dv">3</span>, <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03271484</code></pre>
</div>
</div>
<p><a href="https://doi.org/10.1090/noti2114"><span class="citation" data-cites="lavine2020nams">@lavine2020nams</span></a> Has important insight about this if you are interested. His brief and enlightening paper begins by saying: “A fundamental idea in statistics and data science is that statistical procedures are judged by criteria such as misclassification rates, p-values, or convergence that measure how the procedure performs when applied to many possible data sets. But such measures gloss over quantifying the evidence in a particular data set. We show that assessing a procedure and assessing evidence are distinct. The main distinction is that procedures are assessed unconditionally, i.e., by averaging over many data sets, while evidence must be assessed conditionally by considering only the data at hand.”</p>
<div style="page-break-after: always;"></div>
</section>
<section id="monte-carlo-explorations-of-posterior-distributions" class="level2">
<h2 class="anchored" data-anchor-id="monte-carlo-explorations-of-posterior-distributions">Monte Carlo Explorations of Posterior Distributions</h2>
<p>We now re-examine the case control scenario with a uniform prior and how it can be implemented in R. We first assume that <span class="math inline">\(m_0 = 1, n_0 = 10, m_1 = 7\)</span> and <span class="math inline">\(n_1 = 10\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">=</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we conduct <span class="math inline">\(100,000\)</span> draws from the posterior distributions of <span class="math inline">\(\alpha, \beta\)</span> and <span class="math inline">\(\pi\)</span>, under a uniform prior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>MM <span class="ot">=</span> <span class="dv">100000</span> <span class="co"># monte carlo draws</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>a0 <span class="ot">=</span> b0 <span class="ot">=</span> a1 <span class="ot">=</span> b1 <span class="ot">=</span> p0 <span class="ot">=</span> p1 <span class="ot">=</span> <span class="dv">1</span> <span class="co"># prior hyperparameters (uniform)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fu">rbeta</span>(MM,x1<span class="sc">+</span>b1,n1<span class="sc">-</span>x1<span class="sc">+</span>b0)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fu">rbeta</span>(MM,n0<span class="sc">-</span>x0<span class="sc">+</span>b0,x0<span class="sc">+</span>b1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this case the posterior distribution is available in closed form, so many of the quantities we are interested in are available analytically, or via well-worn and accurate numerical approximations such as the Incomplete Beta function. Even here it is far more straightforward to explore properties of the posteior distribution by generating a sample. For example, it is trivial to derive distributions of arbitrary functions of multiple parameters, which would otherwise normally require some gymnastic around tansformations of variables.</p>
<div style="page-break-after: always;"></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta,<span class="at">nclass=</span><span class="dv">100</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(beta))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(alpha,<span class="at">nclass=</span><span class="dv">100</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(alpha))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Monte Carlo Approximations of the Posterior Distributions of Parameters Alpha and Beta</figcaption>
</figure>
</div>
</div>
</div>
<p>The above figures are the histograms approximating the posterior densities for each of the parameters of interest.</p>
<div style="page-break-after: always;"></div>
<p>We can also obtain summary statistics by directly looking at the mean and standard deviation of the obtained samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(alpha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8333319</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(alpha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1032169</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6667144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1302649</code></pre>
</div>
</div>
<p>We may also examine the positive distribution of the positive predictive value. This illustrate how easy it is to derive posterior distribution of transformations of the variables. To begin, we fix the prevalence of the population at <span class="math inline">\(0.25\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">=</span> <span class="fl">0.25</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>pi.x <span class="ot">=</span> (pi<span class="sc">*</span>beta)<span class="sc">/</span>(pi<span class="sc">*</span>beta <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>pi)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>alpha))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pi.x, <span class="at">nclass =</span> <span class="dv">100</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Posterior Distribution of the Positive Predictive Value</figcaption>
</figure>
</div>
</div>
</div>
<p>We can then obtain a point estimate of the mean of the posterior predictive at a prevalence rate of <span class="math inline">\(0.25\)</span> and the proportion of samples above <span class="math inline">\(0.5\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pi.x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.603947</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pi.x <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.72398</code></pre>
</div>
</div>
<p>The posterior predictive value can be analyzed further. Specifically, we can plot the joint distribution of the posterior predictive value against <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, made using <code>ggplot2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">pty =</span> <span class="st">"s"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">smoothScatter</span>(alpha,pi.x)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">smoothScatter</span>(beta,pi.x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Appoximate Joint Distribution of the Positive Predictive Value and Alpha or Beta</figcaption>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>We may also analyze the sensitivity to a conjugate prior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">10</span>; b1 <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>beta.pre <span class="ot">=</span> <span class="fu">rbeta</span>(MM,b1,b0)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>beta.post <span class="ot">=</span> <span class="fu">rbeta</span>(MM,x1<span class="sc">+</span>b1,n1<span class="sc">-</span>x1<span class="sc">+</span>b0) </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(beta.post),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">"BETA"</span>,<span class="at">main=</span><span class="st">""</span>) </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(beta.pre),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Posterior Visualizations with hyperparameters b0 = 10, b1 = 40</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">2</span>; b1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>beta.pre <span class="ot">=</span> <span class="fu">rbeta</span>(MM,b1,b0)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>beta.post <span class="ot">=</span> <span class="fu">rbeta</span>(MM,x1<span class="sc">+</span>b1,n1<span class="sc">-</span>x1<span class="sc">+</span>b0) </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(beta.post),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">"BETA"</span>,<span class="at">main=</span><span class="st">""</span>) </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(beta.pre),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Posterior Visualizations under b0 = 2, b1 = 2</figcaption>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>We will now focus on the population-based example, whereas previously we saw the case-control study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">=</span> <span class="dv">27</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we conduct <span class="math inline">\(100,000\)</span> draws from the posterior distributions of <span class="math inline">\(\alpha, \beta\)</span> and <span class="math inline">\(\pi\)</span>, under a uniform prior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>MM <span class="ot">=</span> <span class="dv">100000</span> <span class="co"># monte carlo draws</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>a0 <span class="ot">=</span> b0 <span class="ot">=</span> a1 <span class="ot">=</span> b1 <span class="ot">=</span> p0 <span class="ot">=</span> p1 <span class="ot">=</span> <span class="dv">1</span> <span class="co"># prior hyperparameters (uniform) </span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fu">rbeta</span>(MM,x1<span class="sc">+</span>b1,n1<span class="sc">-</span>x1<span class="sc">+</span>b0)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fu">rbeta</span>(MM,n0<span class="sc">-</span>x0<span class="sc">+</span>b0,x0<span class="sc">+</span>b1)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">=</span> <span class="fu">rbeta</span>(MM,n1<span class="sc">+</span>p1,n0<span class="sc">+</span>p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(alpha,<span class="at">nclass=</span><span class="dv">100</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(alpha))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Posterior Distribution of for Alpha, Beta, and Pi Parameters</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta,<span class="at">nclass=</span><span class="dv">100</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(beta))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Posterior Distribution of for Alpha, Beta, and Pi Parameters</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pi,<span class="at">nclass=</span><span class="dv">100</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(pi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Posterior Distribution of for Alpha, Beta, and Pi Parameters</figcaption>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>We can now analyze the distribution associated with the positive predictive value under an unknown prevalence rate, in the population based model. We can obtain summary statistics as before,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pi.x <span class="ot">=</span> (pi<span class="sc">*</span>beta)<span class="sc">/</span>(pi<span class="sc">*</span>beta<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>pi)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>alpha))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pi.x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7170034</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pi.x<span class="sc">&gt;</span>.<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.93317</code></pre>
</div>
</div>
<p>The histogram is as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pi.x,<span class="at">nclass=</span><span class="dv">100</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(pi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Distribution of the Posterior Predictive Value</figcaption>
</figure>
</div>
</div>
</div>
<p>We can then look at the alternate visualization of the joint distribution under an unknown prevalence rate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">pty =</span> <span class="st">"s"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">smoothScatter</span>(alpha, pi.x, <span class="at">xlab =</span> <span class="fu">expression</span>(alpha))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">smoothScatter</span>(beta, pi.x, <span class="at">xlab =</span> <span class="fu">expression</span>(beta))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">smoothScatter</span>(pi, pi.x, <span class="at">xlab =</span> <span class="fu">expression</span>(pi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Alternative Joint Distribution of the Positive Predictive Value and Alpha/Beta/Pi</figcaption>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">"s"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">smoothScatter</span>(<span class="fu">log</span>(beta<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>alpha)),pi.x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="L6-bayes_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Joint Density of PPV versus Log Ratio of Beta/(1-Alpha)</figcaption>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Discussion
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider this scenario: a patient you know well is asking for advice on how to process the risk information they are gathering online.</p>
<ul>
<li><p>how do you describe to them in simple words what the PPV probability represents?</p></li>
<li><p>they also found a Bayesian statement of uncertainty about the relevant PPV (say a posterior IQR). How do you describe the role of the prior in generating this IQR? What questions should they be asking about that prior?</p></li>
</ul>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" role="list">

</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>