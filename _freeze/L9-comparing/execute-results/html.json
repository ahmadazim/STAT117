{
  "hash": "81a3a22731e202ca590a956810c69a15",
  "result": {
    "engine": "knitr",
    "markdown": "\\newpage\n\n# Lecture 9 (February 21, 2023) Comparing Criteria for Biomarker Discovery\n\n## Comparing Criteria for Biomarker Discovery\n\nWith this lecture we move to the search for promising biomarkers in high dimension. \nThis task is implicity in most variable selection and machine learning methodologies.\nHere we will dissect it in a more basic and exploratory way.\n\n### Data\n\nWe will start by going back to the `TCGA_eset` dataset and again consider the debulking variable. From before, this is a binary variable with `optimal` and `suboptimal` debulking. We will code an `optimal` debulking status as $1$ and $0$ otherwise. The biomarkers are on the continuous gene expression scale. We let `XXX` and `YYY` denote the biomarkers on the full set of patients, while `XX` and `YY` represent the biomarkers for the first 100 patients. For this analysis we remove any `NA`'s from both the response and gene expression predictor variables. In real applications we may consider imputation. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(curatedOvarianData)\nlibrary(ROCR)\ndata(TCGA_eset)\nXX = as.matrix(cbind(exprs(TCGA_eset)))\nYY = 1 * as.vector(pData(TCGA_eset)[,\"debulking\"]==\"optimal\")\nXX = XX[,!is.na(YY)]; \nYY = YY[!is.na(YY)]\n\nXXX = XX\nYYY = YY\n# subset\nsubs = 1:100\nXX = XX[,subs]; YY = YY[subs]\n```\n:::\n\n\n\\newpage\n\n### Three Scores\n\nWhat we have next is the `CompScores()` function. This function will compute the AUC, the negative log p-value, fold change, and the residual error associated with each gene on the subset of patients. The fold change is the difference in means, so names becasue the expression measurements in the Affy platform have been logged as part of the preprocessing. The residual error considers deviations of biomarker values from their class-specific means, and it includes two general sources of variation: expression measurement error and patient-to-patient variation. \n\nThese are only a few of the scores one can compute, of course. A good way to contribute to the discussion is to add your favorite metric to the mix and start exploring.\n\nNow we run the function on the first 100 patients. We save the full set for later.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(\"RScripts/Scores.R\")\nScores = CompScores(XX,YY)\n```\n:::\n\n\n\\newpage\nWe will now focus on the sample of 100 first. To begin, we threshold negative log p-value at $4.25$, AUC at $0.66$, and the fold change at $0.5$ and tabulate the results. TRUE and FALSE refer to whether the score exceeds the cutoff.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npcut = 4.25\nacut = .66\nfcut = .5\n\ntable( abs(Scores[,\"FoldChange\"])>fcut , \n       Scores[,\"nlpvalueT\"]>pcut, \n       Scores[,\"AUC\"]>acut, dnn = c(\"FoldChange\",\"nlpvalueT\",\"AUC\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n, , AUC = FALSE\n\n          nlpvalueT\nFoldChange FALSE  TRUE\n     FALSE 12514    56\n     TRUE    118     7\n\n, , AUC = TRUE\n\n          nlpvalueT\nFoldChange FALSE  TRUE\n     FALSE   203   158\n     TRUE     24    24\n```\n\n\n:::\n:::\n\n\n::: callout-note\n* Did you expect more agreement? Less?\n:::\n\n\\newpage\nFor later use.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallTrue = abs(Scores[,\"FoldChange\"])>fcut & \n    Scores[,\"nlpvalueT\"]>pcut & Scores[,\"AUC\"]>acut\naucOnly = abs(Scores[,\"FoldChange\"])<fcut & \n    Scores[,\"nlpvalueT\"]<pcut & Scores[,\"AUC\"]>acut\npOnly = abs(Scores[,\"FoldChange\"])<fcut & \n    Scores[,\"nlpvalueT\"]>pcut & Scores[,\"AUC\"]<acut\nfcOnly = abs(Scores[,\"FoldChange\"])>fcut & \n    Scores[,\"nlpvalueT\"]<pcut & Scores[,\"AUC\"]<acut\nlowresi = (1:nrow(Scores))[Scores[,\"ResiErr\"]<.5^2]\nhighauc_lowresi <- rownames(Scores[Scores[,\"ResiErr\"]<.5 & Scores[,\"AUC\"]>acut,])\nlowauc_lowresi <- rownames(Scores[Scores[,\"ResiErr\"]<.5 & Scores[,\"AUC\"]<acut,])\nhighauc_higherresi <- rownames(XX[which(Scores[,\"ResiErr\"]>.8 & Scores[,\"AUC\"]>acut,)])\n```\n:::\n\n\n\\newpage\n### Pairwise Comparisons of Scores\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(GGally)\nlowresi = Scores[,\"ResiErr\"]<.25\nplotme = cbind(Scores,lowresi)\nggpairs(plotme,\n        columns = 1:4,\n        aes(color = plotme[,5],alpha=.7),\n        lower = list(continuous = wrap(\"points\", alpha = 0.05)))\n```\n\n::: {.cell-output-display}\n![Pairwise comparison of Scores](L9-comparing_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n\n* are the residual error and fold change correlated? Are they independent?\n:::\n\n### AUC and Fold Change\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(pty = \"m\")\nplot(Scores[,\"FoldChange\"],Scores[,\"AUC\"],pch=\".\", cex = 2)\npoints(Scores[lowresi,\"FoldChange\"],Scores[lowresi,\"AUC\"],col=\"green\",pch=\".\", cex = 2)\nabline(h = acut, lty = \"dashed\", col = \"deepskyblue3\")\n```\n\n::: {.cell-output-display}\n![AUC on Fold Change with Green Points labeling Low Residual Error](L9-comparing_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\\newpage\n\nFor three specific biomarkers from each of the lists above, we will now plot their empirical densities. This will allow us to better understand how it is possible to have a low variance but high score in the AUC. Furthermore, what a biomarker with a high AUC but also a high variance looks like. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nACADM = XX[\"ACADM\",]\nScores[\"ACADM\",]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            AUC nlpvalueT FoldChange   ResiErr\nACADM 0.6802168  3.919139 -0.4339855 0.6550141\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(density(ACADM[YY==1]),xlab=c(\"Log Expression\",\"ACADM\"),main = \"\", col= \"blue\")\nlines(density(ACADM[YY==0]), col=\"green\")\nrug(ACADM[YY==0],ticksize = .1,lwd=2, col = \"green\")\nrug(ACADM[YY==1],ticksize = .1,lwd=2, col = \"blue\")\n```\n\n::: {.cell-output-display}\n![Density Plots](L9-comparing_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\\newpage\n\n\n::: {.cell}\n\n```{.r .cell-code}\nA4GNT = XX[\"A4GNT\",]\nScores[\"A4GNT\",]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          AUC nlpvalueT FoldChange   ResiErr\nA4GNT 0.50271 0.4490836 0.01979107 0.1715732\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(density(A4GNT[YY==0]),xlab=c(\"Log Expression\",\"A4GNT\"),\n     main = \"\",ylim=c(0,3), col= \"green\")\nlines(density(A4GNT[YY==1]), col=\"blue\")\nrug(A4GNT[YY==0],ticksize = .1,lwd=2, col = \"green\")\nrug(A4GNT[YY==1],ticksize = .1,lwd=2, col = \"blue\")\n```\n\n::: {.cell-output-display}\n![Density Plots for A4GNT](L9-comparing_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\\newpage\n\nThis is a tyrosine kinase.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nARHGAP33 = XX[\"ARHGAP33\",]\nScores[\"ARHGAP33\",]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               AUC nlpvalueT FoldChange   ResiErr\nARHGAP33 0.6944444  2.975095 -0.4351615 0.7970158\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(density(ARHGAP33[YY==0]),xlab=c(\"Log Expression\",\"ARHGAP33\"),main = \"\",ylim=c(0,1), col= \"green\")\nlines(density(ARHGAP33[YY==1]), col=\"blue\")\nrug(ARHGAP33[YY==0],ticksize = .1,lwd=2, col = \"green\")\nrug(ARHGAP33[YY==1],ticksize = .1,lwd=2, col = \"blue\")\n```\n\n::: {.cell-output-display}\n![Density Plots for ARHGAP33](L9-comparing_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\\newpage\n\n### Negative Log P-Value and Fold Change.\n\nThe following plot, sometimes called a volcano plot, is the negative log p-value against the fold change. The blue dotted horizontal line corresponds to where an $\\alpha = 0.05$ significance level would sit. Everything above the blue dotted line would indicated $\\alpha = 0.05$ significance. The darker green dotted lines show where a (logged) fold chance of 0.5 would be on either side. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(Scores[,\"FoldChange\"],Scores[,\"nlpvalueT\"],pch=\".\", cex = 2)\nlowresi = (1:nrow(Scores))[Scores[,\"ResiErr\"] < .5]\npoints(Scores[lowresi,\"FoldChange\"],Scores[lowresi,\"nlpvalueT\"],col=\"green\",pch=\".\")\nabline(h = -log(0.05), lty = \"dashed\", col = \"deepskyblue3\")\nabline(v = 0.5, lty = \"dashed\", col = \"darkgreen\")\nabline(v = -0.5, lty = \"dashed\", col = \"darkgreen\")\ninterest = (1:nrow(Scores))[abs(Scores[,\"FoldChange\"])>0.5 & \n                                abs(Scores[,\"nlpvalueT\"])>-log(0.05)]\npoints(Scores[interest,\"FoldChange\"],Scores[interest,\"nlpvalueT\"],col=\"red\",pch=\".\")\n```\n\n::: {.cell-output-display}\n![Negative Log P-Value versus Fold Change](L9-comparing_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n\nTo practitioners in biology, the top left and top right quadrants indicate biomarkers of exceptional interest. Why might the combination of the two conditions of interest to them?\n\n:::\n\n\n\\newpage\n\n### Negative Log P-Value and AUC.\n\nWe now have the nlpvalue against the AUC. We see that there is a linear trend in general. The top right quadrant would indicate biomarkers of specific interest. The green points indicate biomarkers of low variance. We see that the low variance genes don't appear to be specifically clustered.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(Scores[,\"nlpvalueT\"],Scores[,\"AUC\"],pch=\".\", main = \"NLP-value vs. AUC\", cex = 2)\nlowresi = (1:nrow(Scores))[Scores[,\"ResiErr\"]<.5^2]\npoints(Scores[lowresi,\"nlpvalueT\"],Scores[lowresi,\"AUC\"],col=\"green\",pch=\".\", cex = 2)\nabline(h = 0.66, lty = \"dashed\", col = \"deepskyblue3\")\nabline(v = -log(0.05), lty = \"dashed\", col = \"deepskyblue3\")\n```\n\n::: {.cell-output-display}\n![Negative Log P-Value on AUC](L9-comparing_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n\n* are the residual error and fold change correlated? Are they independent?\n:::\n\n\n\\newpage\n\nLet's revisit the marginal distribution of Residual Errors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(sqrt(Scores[,\"ResiErr\"]),nclass=100)\n```\n\n::: {.cell-output-display}\n![Marginal Histogram of Residual Errors](L9-comparing_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nIt is apparent that there are two \"humps\" in the graph. The first hump are genes with low residual error. These are generally genes with low dynamic range and whose overall variability is small but dominated by technical noise. The second hump are points with higher residual error, predominantly drive by biological variability across subjects. These are also more likely to provide detectable signal when comparing across classes.\n\n\n\\newpage\n\n### Negative Log P-Value and Residual Error.\n\nWe now plot the nlpvalue against the residual error. The red dotted line indicates where points with a standard deviation of 0.2 would sit. The blue dotted line shows where an $\\alpha = 0.05$ significance level would be at. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(sqrt(Scores[,\"ResiErr\"]),Scores[,\"nlpvalueT\"],pch=\".\",cex = 2)\npoints(sqrt(Scores[lowresi,\"ResiErr\"]),Scores[lowresi,\"nlpvalueT\"],col=\"green\",pch=\".\", cex = 3)\nabline(h = -log(0.05), lty = \"dashed\", col = \"deepskyblue3\")\nabline(v = 0.2, lty = \"dashed\", col = \"red\")\n```\n\n::: {.cell-output-display}\n![Negative Log P-Value versus Standard Deviation](L9-comparing_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\\newpage\n\n## Visualizations of Individual Biomarkers.\n\nWe now would like to examine individual biomarkers that satisfy varying criteria in the `CompScores()` function. The names of the biomarkers that satisfy all three criteria, only the p-value, only the AUC, and only the fold change are given by the following vectors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallTrueNames <- rownames(XX)[(1:length(allTrue))[allTrue==\"TRUE\"]]\npOnlyNames   <- rownames(XX)[(1:length(pOnly))[pOnly==\"TRUE\"]]\naucOnlyNames <- rownames(XX)[(1:length(aucOnly))[aucOnly==\"TRUE\"]]\nfcOnlyNames  <- rownames(XX)[(1:length(fcOnly))[fcOnly==\"TRUE\"]]\n```\n:::\n\n\n\\newpage\n\n### A biomarker meeting all three criteria above.\n\nWe first look at a gene that fulfills all three criteria and visualize its properties.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ROCR)\npar(pty=\"s\", mfrow = c(1,3))\nggg = 1485\nrownames(XX)[ggg] # CADM1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"CADM1\"\n```\n\n\n:::\n\n```{.r .cell-code}\nround(Scores[ggg,],digits=2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       AUC nlpvalueT FoldChange ResiErr\nCADM1 0.72      4.53       0.68    0.93\n```\n\n\n:::\n\n```{.r .cell-code}\nrownames(XX)[ggg]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"CADM1\"\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(density(XX[ggg,YY==0]),xlim=c(3,11), ylim = c(0, 0.7), main = \"\"); lines(density(XX[ggg,YY==1]),col=3); rug(XX[ggg,YY==1],.1,lwd=1.5, col=3); rug(XX[ggg,YY==0],.1,lwd=2)\nqqplot(XX[ggg,YY==0],XX[ggg,YY==1],asp=1); abline(0,1)\nplot(performance(prediction(as.vector(XX[ggg,]),YY),\"tpr\",\"fpr\")); abline(0,1, col = \"red\")\n```\n\n::: {.cell-output-display}\n![Visualizations for CADM1 - All 3 Criteria Satisfied](L9-comparing_files/figure-html/unnamed-chunk-15-1.png){width=\\textwidth height=\\textheight}\n:::\n:::\n\n\n\n\\newpage\n### Selecting by P-value Only\n\nWe now look at a gene that only satisfies the p-value only, but NOT the other two criteria.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(pty=\"s\", mfrow = c(1,3))\nggg = 211\nrownames(XX)[ggg] # ADAMTSL3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"ADAMTSL3\"\n```\n\n\n:::\n\n```{.r .cell-code}\nround(Scores[ggg,],digits=2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          AUC nlpvalueT FoldChange ResiErr\nADAMTSL3 0.64      4.97       0.21    0.43\n```\n\n\n:::\n\n```{.r .cell-code}\nrownames(XX)[ggg]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"ADAMTSL3\"\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(density(XX[ggg,YY==0]),xlim=c(2,6), main = \"\"); lines(density(XX[ggg,YY==1]),col=3); rug(XX[ggg,YY==1],.1,lwd=1.5, col=3); rug(XX[ggg,YY==0],.1,lwd=2)\nqqplot(XX[ggg,YY==0],XX[ggg,YY==1],asp=1); abline(0,1)\nplot(performance(prediction(as.vector(XX[ggg,]),YY),\"tpr\",\"fpr\")); abline(0,1)\n```\n\n::: {.cell-output-display}\n![Visualizations for ADAMTSL3 - Satisfying P-value Only](L9-comparing_files/figure-html/unnamed-chunk-16-1.png){width=\\textwidth height=\\textheight}\n:::\n:::\n\n\n\\newpage\n\nWe can now look at where the `ADAMTSL3` biomarker sits with relation to the rest of the biomarkers in our dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,3))\nhist(Scores[, \"FoldChange\"], breaks = 100, main = \"Fold Change\")\nabline(v=Scores[ggg,][\"FoldChange\"], col = \"red\")\nhist(Scores[, \"ResiErr\"], breaks = 100, main = \"ResiErr\")\nabline(v=Scores[ggg,][\"ResiErr\"], col = \"red\")\nhist(Scores[, \"nlpvalueT\"], breaks = 100, main = \"NLPValue\")\nabline(v=Scores[ggg,][\"nlpvalueT\"], col = \"red\")\n```\n\n::: {.cell-output-display}\n![FC, ResiErr, and NLP-value Histograms for ADAMTSL3](L9-comparing_files/figure-html/unnamed-chunk-17-1.png){width=960}\n:::\n:::\n\n\n\\newpage\n\n### Selecting by AUC Only\n\nWe now look at a gene that only satisfies the AUC only, but NOT the other two criteria.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(pty=\"s\", mfrow = c(1,3))\nggg = 9952\nrownames(XX)[ggg] # SAYSD1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"SAYSD1\"\n```\n\n\n:::\n\n```{.r .cell-code}\nround(Scores[ggg,],digits=2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        AUC nlpvalueT FoldChange ResiErr\nSAYSD1 0.68      4.22       0.33    0.49\n```\n\n\n:::\n\n```{.r .cell-code}\nrownames(XX)[ggg]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"SAYSD1\"\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(density(XX[ggg,YY==0]), main = \"\"); \nlines(density(XX[ggg,YY==1]),col=3); \nrug(XX[ggg,YY==1],.1,lwd=1.5, col=3); \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in rug(XX[ggg, YY == 1], 0.1, lwd = 1.5, col = 3): some values will be\nclipped\n```\n\n\n:::\n\n```{.r .cell-code}\nrug(XX[ggg,YY==0],.1,lwd=2)\nqqplot(XX[ggg,YY==0],XX[ggg,YY==1],asp=1); abline(0,1, col = \"red\")\nplot(performance(prediction(as.vector(XX[ggg,]),YY),\"tpr\",\"fpr\")); abline(0,1)\n```\n\n::: {.cell-output-display}\n![Visualizations for SAYSD1 - Satisfying AUC Only](L9-comparing_files/figure-html/unnamed-chunk-18-1.png){width=960}\n:::\n:::\n\n\n\\newpage\nAgain, we can look at where the `SAYSD1` biomarker sits with relation to the rest of the biomarkers in our dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nhist(Scores[, \"AUC\"], breaks = 100, main = \"AUC\")\nabline(v=Scores[ggg,][\"AUC\"], col = \"red\")\nhist(Scores[, \"nlpvalueT\"], breaks = 100, main = \"NLPValue\")\nabline(v=Scores[ggg,][\"nlpvalueT\"], col = \"red\")\n```\n\n::: {.cell-output-display}\n![AUC and NLP-value Histograms for SAYSD1](L9-comparing_files/figure-html/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n\n\\newpage\n\n### Selecting by Fold Change Only\n\nWe finally look at a biomarker that only satisfies the fold change criteria.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(pty=\"s\", mfrow = c(1,3))\nggg = 9903\nrownames(XX)[ggg] # S100A9\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"S100A9\"\n```\n\n\n:::\n\n```{.r .cell-code}\nround(Scores[ggg,],digits=2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        AUC nlpvalueT FoldChange ResiErr\nS100A9 0.57      1.59       0.52    1.76\n```\n\n\n:::\n\n```{.r .cell-code}\nrownames(XX)[ggg]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"S100A9\"\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(density(XX[ggg,YY==0]), main = \"\"); \nlines(density(XX[ggg,YY==1]),col=3); rug(XX[ggg,YY==1],.1,lwd=1.5, col=3); \nrug(XX[ggg,YY==0],.1,lwd=2)\nqqplot(XX[ggg,YY==0],XX[ggg,YY==1],asp=1); abline(0,1)\nplot(performance(prediction(as.vector(XX[ggg,]),YY),\"tpr\",\"fpr\")); abline(0,1)\n```\n\n::: {.cell-output-display}\n![Visualizations for S100A9 - Satisfying Fold Change Only](L9-comparing_files/figure-html/unnamed-chunk-20-1.png){width=960}\n:::\n:::\n\n\nwe can look at where the `S100A9` biomarker sits with relation to the rest of the biomarkers in our dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,3))\nhist(Scores[, \"FoldChange\"], breaks = 100, main = \"Fold Change\")\nabline(v=Scores[ggg,][\"AUC\"], col = \"red\")\nhist(Scores[, \"ResiErr\"], breaks = 100, main = \"Residual Error\")\nabline(v=Scores[ggg,][\"ResiErr\"], col = \"red\")\nhist(Scores[, \"nlpvalueT\"], breaks = 100, main = \"NLPValue\")\nabline(v=Scores[ggg,][\"nlpvalueT\"], col = \"red\")\n```\n\n::: {.cell-output-display}\n![FC, ResiErr, and NLP-value Histograms for S100A9](L9-comparing_files/figure-html/unnamed-chunk-21-1.png){width=960}\n:::\n:::\n\n\n## To log or not to log\n\nOptional material.\n\nIt is interesting to explore the effect of having logged the data on the discovery process. \nHere, just to play a bit, I created the same scores after exponentiating the expression measurements.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nScoresExp = CompScores(exp(XX),YY)\n```\n:::\n\n\n::: callout-note\nHow would you think about whether to log or not?\nHere are a few plots to get you started. \n\nIt would be nice to have a gold standard, or at least some sort of validation. What options do we have? \n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(log(ScoresExp[,\"ResiErr\"]),nclass=100)\n```\n\n::: {.cell-output-display}\n![Marginal Histogram of Residual Errors in Raw Intensity Scale (the x scale is logged for resolution, but the scores are computed in the raw scale).](L9-comparing_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlowresiExp = ScoresExp[,\"ResiErr\"] < exp(3)\nplot(log(ScoresExp[,\"ResiErr\"]),ScoresExp[,\"nlpvalueT\"],pch=\".\",cex = 2)\npoints(log(Scores[lowresiExp,\"ResiErr\"]),Scores[lowresiExp,\"nlpvalueT\"],col=\"green\",pch=\".\", cex = 3)\n```\n\n::: {.cell-output-display}\n![Negative Log P-Value versus Standard Deviation](L9-comparing_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(Scores[,\"nlpvalueT\"],ScoresExp[,\"nlpvalueT\"],pch=\".\",cex = 2)\n```\n\n::: {.cell-output-display}\n![Negative Log P-Value with and without logging (is that a verb in math?)](L9-comparing_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(log(abs(ScoresExp[,\"FoldChange\"])),ScoresExp[,\"nlpvalueT\"],pch=\".\",cex = 1.5)\n```\n\n::: {.cell-output-display}\n![Volcano plot w/out logging (the x scale is logged for resolution, but the scores are computed in the raw scale).](L9-comparing_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}