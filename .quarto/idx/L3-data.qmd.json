<<<<<<< HEAD
{"title":"Lecture 3: Data","markdown":{"yaml":{"date":"January 30, 2024"},"headingText":"Lecture 3: Data","containsRefs":true,"markdown":"\n\n\n## High Throughput Gene Expression Measurement\n\n### Steps of Gene Expression Measurement\n\n-   Specimen Acquisition (get the samples, preserve them between the clinic and the lab, isolate the cells of interest etc)\n\n-   Extraction / Preparation Protocols (extract RNA from the samples, often do additional preparation to get it ready for analysis (e.g add tags); often convert RNA into complementary DNA, or cDNA; break sequences into tiny fragments to be reassembled later)\n\n-   Quantification (run the experiment)\n\n-   Raw Data (typically images)\n\n-   Your Data (a heavily preprocessed summary attempting to quantify expression at the aggregate level of a \"gene\")\n\n{{< pagebreak >}}\n\n### Affymetrix Microarrays (\"Affy\")\n\nWe will work with expression data after it has been preprocessed and summarized at the gene label level. We will analyze a lot of data from the Affy platform. Preprocessing is a statistically challenging step. Some of the most important issues for Affymetrix data are discussed by [\\@Owzar2008ccr](https://clincancerres.aacrjournals.org/content/clincanres/14/19/5959.full.pdf)\n\nI also highly recommend [Katerina Taskova's Introduction to Microarray Analysis](https://cbdm.uni-mainz.de/files/2016/02/GE_microarrays.pdf) slide deck.\n\n::: callout-note\n### Reading Notes\n\n-   RMA (slides 13-17) was used to preprocess the data we will use. A high-level understanding is useful. It produces summaries of expression at the level of the probe-set.\n\n-   It is useful to know the difference between a probe (a single 25-nucleotide sequence), a probe-set (a group of probes predicted to appear on the coding sequence of a gene) and a gene (a region of DNA believed to often be the source of information for the production of a particular set of related proteins).\n\n-   Multiple probe-sets can map the same gene (for a digression about this see [@stalteri2007bmcb]) To keep things simple and to cross-reference features across technologies we have averaged over these and will use data at the gene level [@ganzfried2013curatedovariandata].\n\n-   Think about quantile normalization (QN) when looking at Slide 19. Does QN help? Does it remove the artifact in bad.cel completely? Does it remove the \"fog\" in NEG10-1?\n\n-   We will cover differential expression later in the course (Slides 23-29). You are welcome to take a peek, but you can skip for now.\n\n-   Each of the bullets on Slide 30 embeds its own sources of both noise and systematic biases.\n:::\n\nMultiple probe sets for the same gene in Affy are sometimes designed to capture different isoforms (that is messenger RNAs made with different selection of exons). Because Affy needs to position probes near one end of the gene (long story), the extent to which they can capture different isoforms is not great compared to RNA-seq. But there could certainly be exceptions. Affy also used multiple probe sets to increase the number of probes dedicated to a certain genes, when the gene is important or there is uncertainty about mapping. In these cases averaging actually helps.\n\nRabbit hole: For those interested in a digression on imaging approaches (not covered at all in the class) including a menagerie of artifacts, see [\\@arteaga-salas2007bb](http://dx.doi.org/10.1093/bib/bbm055)\n\n{{< pagebreak >}}\n\n### RNA-seq\n\nRNA-seq is the current alternative to hybridization microarrays. There are several RNA-seq datasets in the CuratedOvarianCanceer and CuratedBreastCancer package you will use in this class, but RNA-seq data exploration will be mostly optional. The main statistical lessons for this course can be learned equally well from Affy data. Of course I would not say this about a Bioinformatics class.\n\nFor those interested in understanding RNA-seq a bit more, I recommend the sections \"Overview\" and \"Alignment and Quantification\" from [\\@VandenBerge2019arbds](https://doi.org/10.1146/annurev-biodatasci-072018-021255)\n\n\n[\\@Xu2013bmcb](https://doi.org/10.1186/1471-2105-14-S9-S1) report a head-to-head comparison of Affy and RNA-seq high throughput measurements. RNA-seq generates count data. It is interesting to look at [Figure 1](https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-S9-S1/figures/1) and think about how to interpret the \"stripes\" in panel B.\n\nMicroarrays are rarely used for discovery these days. Many of the statistical challenges of biomarker discovery, however, have remained the same. The advantage of using microarrays for this course is there there are far more studies readily available, so certain parts of the course still work a lot better with microarray than RNA-seq.\n\n::: callout-important\n## Question for Debate\n\nWhat are some of the advantages and disadvantages of RNA-Seq compared to microarray techniques, especially in terms of identification of differentially expressed genes, cost, and other factors?\n:::\n\n\n{{< pagebreak >}}\n\n## Batch Effects\n\nHigh-throughput biology data are often produced in batches for efficiency or practical restrictions. Differences across how these batches are handled (in any of the bullets in Slide 30 of [Katerina Taskova's Introduction to Microarray Analysis](https://cbdm.uni-mainz.de/files/2016/02/GE_microarrays.pdf)), can drive significant variation across batches, resulting in so-called batch effects.\n\nCuratedOvarianData has been preprocessed to adjust for batches defined by the study of origin using [Combat](https://www.bu.edu/jlab/wp-assets/ComBat/Download.html) [@Johnson2006]. Other batch effects may be present.\n\n[\\@Leek2010nrg](https://doi.org/10.1038/nrg2825) wrote a useful overview of batch effects.\n\n{{< pagebreak >}}\n\n## The CuratedOvarianData package\n\n### Background\n\nComprehensive review of predictors and datasets for signature validation [\\@Waldron2014](https://academic.oup.com/jnci/article-abstract/106/5/dju049/2606979)\n\n{{< pagebreak >}}\n\n### Preprocessing of Gene Expression Data in CuratedOvarianData\n\n![Scheme of preprocessing pipeline for the CuratedOvarianData Package](Figures/GanzfriedF1b.pdf)\n\nDetailed description of dataset [\\@ganzfried2013curatedovariandata](https://academic.oup.com/database/article-abstract/doi/10.1093/database/bat013/330978)\n\n{{< pagebreak >}}\n\n### Clinical Phenotypes in the CuratedOvarianData Package\n\n![This heatmap visualizes for each curated clinical characteristic (rows) the availability in each data set (columns). Red indicates that the corresponding characteristic is available for at least one sample in the data set. See [\\@ganzfried2013curatedovariandata](https://academic.oup.com/database/article-abstract/doi/10.1093/database/bat013/330978) for further details.](Figures/GanzfriedF2.pdf)\n\nIt may seem disappointing that there are only two clinical annotations that all of these datasets have. When we originally created the dataset we recontacted all the groups that originally generated the data to try to fill as many of the gaps as possible. Unfortunately some of the clinical data may not have been collected, or may not be easy to share due to privacy concerns or investigators' reluctance. Since we compiled this data, the field has moved towards larger coordinated efforts across multiple institutions, which have had better outcomes in terms of completeness and homogeneity of phenotypes. An example is [PCAWG](https://dcc.icgc.org/) but heterogeneity and missingness of labels remain important issues in health data.\n\n::: callout-important\n## Question for Debate\n\nHandling missing data is a prominent challenge, particularly in the context of clinical data collection. What data collection standards should be in place, and what are some effective methods for managing missingness (and more broadly, data quality) in these datasets?\n:::\n\n{{< pagebreak >}}\n\n### Loading the Package and Extracting Expression Data Matrices\n\nWe next load the CuratedOvarianData package and two datasets contained within. For now we will only consider the datasets `TCGA_eset` and `GSE32063_eset`. To check important characteristics of each of the studies, just enter the study ID (for example GSE32063) in the [Gene Expression Omnibus query page](https://www.ncbi.nlm.nih.gov/geo/)\n\n```{r, echo=T, message=F, warnings = F, cache=F}\nlibrary(curatedOvarianData)\n# data(package=\"curatedOvarianData\")\n# Above line would lists all datasets available within the package.\ndata(TCGA_eset)\ndata(GSE32063_eset)\n```\n\n{{< pagebreak >}}\n\n```{r, echo=T, message=F, warnings = F, cache=F}\nhead(exprs(TCGA_eset)[1:6,1:6])\nhead(exprs(GSE32063_eset)[1:6,1:6])\n```\n\n{{< pagebreak >}}\n\n### Basic Visualizations\n\nClustered heatmap of the top 100 most variable genes in the first 50 samples in TCGA. The expression scale is the log of the pre-processed intensities.\n\n```{r, echo=T, message=F, warnings = F, cache=F, fig.height=5, fig.width=10}\nsds = apply(exprs(TCGA_eset)[,1:50],1,sd)\nlibrary(gplots)\nheatmap.2((exprs(TCGA_eset)[,1:50])[order(sds,decreasing=TRUE)[1:20],],\n          margins = c(6, 10))\n```\n\nTrees (dendrograms) on the top and sides represent the result of hierarchical clustering. The goal is to reorder rows and columns so that similar rows (column) are close to each other. In this case I am using them to facilitate visualization, but this is also a technique to identify patterns in the data or divide them into subgroups. This is a general overview [\\@Garrett2005](https://biostats.bepress.com/jhubiostat/paper70/)\n\nThe heatmap.2 function calls hclust to produce the dendrograms. The procedure is agglomerative ---it starts by joining single rows, and proceeds iteratively from the bottom up. The lenth of the branches grows with the distance of the two entities (rows of clusters of rows) being joined. The default agglomeration method is the \"complete linkage\" method in which clusters are linked based on the similarity of the furthest members. Same for columns.\n\nBlue lines. Inside the legend: histogram frequencies; inside the heat map, the distance of the line from the center of each color-cell is proportional to the size of the measurement (overkill? depends, people perceive location differently from color so it could help). {{< pagebreak >}}\n\nDistribution of location (median) and scale (Interquartile Range, or IQR), by gene and by sample.\n\n```{r, echo=T, message=F, warnings = F, cache=F}\niqr.g = apply(exprs(TCGA_eset),1,IQR) #\nhist(iqr.g, main =\"IQR by gene\")\niqr.s = apply(exprs(TCGA_eset),2,IQR) \nhist(iqr.s, main =\"IQR by sample\")\nmed.g = apply(exprs(TCGA_eset),1,median)\nhist(med.g, main =\"median by gene\")\nmed.s = apply(exprs(TCGA_eset),2,median)\nhist(med.s, main =\"median by sample\")\n```\n\n::: callout-note\n### Quantile Normlization\n\nIf quantile normalization was applied by sample, why aren't all medians and all IQR's the same in the histograms by sample?\n\nAt least two reasons: 1) QN was applied at the proble level. Within each study data sere subsequently aggregated first by probeset and then by gene. 2) To (hopefully) increase comparabiity across studies, data where further process with a batch adjustment model that regresses out gene specific effects.\n:::\n\n{{< pagebreak >}}\n\nClustered heatmap of the top 100 most variable genes in the Yoshirara study. The technology is Agilent. [\\@yoshihara2012](https://doi.org/10.1158/1078-0432.CCR-11-2725) describes the preprocessing approach. This set of 40 patients is \"Dataset B\" in [@yoshihara2012].\n\n```{r, echo=T, message=F, warnings = F, cache=F, fig.height=5, fig.width=10}\nsds = apply(exprs(GSE32063_eset),1,sd)\nlibrary(gplots)\nheatmap.2(exprs(GSE32063_eset)[order(sds,decreasing=TRUE)[1:20],])\n```\n\n{{< pagebreak >}}\n\nDistribution of location (median) and scale (Interquartile Range, or IQR), by gene and by sample.\n\n```{r, echo=T, message=F, warnings = F, cache=F}\niqr.g = apply(exprs(GSE32063_eset),1,IQR)\nhist(iqr.g, main =\"IQR by gene\")\niqr.s = apply(exprs(GSE32063_eset),2,IQR) \nhist(iqr.s, main =\"IQR by sample\")\nmed.g = apply(exprs(GSE32063_eset),1,median)\nhist(med.g, main =\"median by gene\")\nmed.s = apply(exprs(GSE32063_eset),2,median)\nhist(med.s, main =\"median by sample\")\n```\n\n::: callout-important\n## Question for Debate\n\nA variety of data normalization are performed in RNA-Seq analysis. What are some of the different methods of normalization, and what is their impact on data interpretability?\n:::\n\n\n## References\n\n::: {#refs}\n:::\n","srcMarkdownNoYaml":"\n\n# Lecture 3: Data\n\n## High Throughput Gene Expression Measurement\n\n### Steps of Gene Expression Measurement\n\n-   Specimen Acquisition (get the samples, preserve them between the clinic and the lab, isolate the cells of interest etc)\n\n-   Extraction / Preparation Protocols (extract RNA from the samples, often do additional preparation to get it ready for analysis (e.g add tags); often convert RNA into complementary DNA, or cDNA; break sequences into tiny fragments to be reassembled later)\n\n-   Quantification (run the experiment)\n\n-   Raw Data (typically images)\n\n-   Your Data (a heavily preprocessed summary attempting to quantify expression at the aggregate level of a \"gene\")\n\n{{< pagebreak >}}\n\n### Affymetrix Microarrays (\"Affy\")\n\nWe will work with expression data after it has been preprocessed and summarized at the gene label level. We will analyze a lot of data from the Affy platform. Preprocessing is a statistically challenging step. Some of the most important issues for Affymetrix data are discussed by [\\@Owzar2008ccr](https://clincancerres.aacrjournals.org/content/clincanres/14/19/5959.full.pdf)\n\nI also highly recommend [Katerina Taskova's Introduction to Microarray Analysis](https://cbdm.uni-mainz.de/files/2016/02/GE_microarrays.pdf) slide deck.\n\n::: callout-note\n### Reading Notes\n\n-   RMA (slides 13-17) was used to preprocess the data we will use. A high-level understanding is useful. It produces summaries of expression at the level of the probe-set.\n\n-   It is useful to know the difference between a probe (a single 25-nucleotide sequence), a probe-set (a group of probes predicted to appear on the coding sequence of a gene) and a gene (a region of DNA believed to often be the source of information for the production of a particular set of related proteins).\n\n-   Multiple probe-sets can map the same gene (for a digression about this see [@stalteri2007bmcb]) To keep things simple and to cross-reference features across technologies we have averaged over these and will use data at the gene level [@ganzfried2013curatedovariandata].\n\n-   Think about quantile normalization (QN) when looking at Slide 19. Does QN help? Does it remove the artifact in bad.cel completely? Does it remove the \"fog\" in NEG10-1?\n\n-   We will cover differential expression later in the course (Slides 23-29). You are welcome to take a peek, but you can skip for now.\n\n-   Each of the bullets on Slide 30 embeds its own sources of both noise and systematic biases.\n:::\n\nMultiple probe sets for the same gene in Affy are sometimes designed to capture different isoforms (that is messenger RNAs made with different selection of exons). Because Affy needs to position probes near one end of the gene (long story), the extent to which they can capture different isoforms is not great compared to RNA-seq. But there could certainly be exceptions. Affy also used multiple probe sets to increase the number of probes dedicated to a certain genes, when the gene is important or there is uncertainty about mapping. In these cases averaging actually helps.\n\nRabbit hole: For those interested in a digression on imaging approaches (not covered at all in the class) including a menagerie of artifacts, see [\\@arteaga-salas2007bb](http://dx.doi.org/10.1093/bib/bbm055)\n\n{{< pagebreak >}}\n\n### RNA-seq\n\nRNA-seq is the current alternative to hybridization microarrays. There are several RNA-seq datasets in the CuratedOvarianCanceer and CuratedBreastCancer package you will use in this class, but RNA-seq data exploration will be mostly optional. The main statistical lessons for this course can be learned equally well from Affy data. Of course I would not say this about a Bioinformatics class.\n\nFor those interested in understanding RNA-seq a bit more, I recommend the sections \"Overview\" and \"Alignment and Quantification\" from [\\@VandenBerge2019arbds](https://doi.org/10.1146/annurev-biodatasci-072018-021255)\n\n\n[\\@Xu2013bmcb](https://doi.org/10.1186/1471-2105-14-S9-S1) report a head-to-head comparison of Affy and RNA-seq high throughput measurements. RNA-seq generates count data. It is interesting to look at [Figure 1](https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-S9-S1/figures/1) and think about how to interpret the \"stripes\" in panel B.\n\nMicroarrays are rarely used for discovery these days. Many of the statistical challenges of biomarker discovery, however, have remained the same. The advantage of using microarrays for this course is there there are far more studies readily available, so certain parts of the course still work a lot better with microarray than RNA-seq.\n\n::: callout-important\n## Question for Debate\n\nWhat are some of the advantages and disadvantages of RNA-Seq compared to microarray techniques, especially in terms of identification of differentially expressed genes, cost, and other factors?\n:::\n\n\n{{< pagebreak >}}\n\n## Batch Effects\n\nHigh-throughput biology data are often produced in batches for efficiency or practical restrictions. Differences across how these batches are handled (in any of the bullets in Slide 30 of [Katerina Taskova's Introduction to Microarray Analysis](https://cbdm.uni-mainz.de/files/2016/02/GE_microarrays.pdf)), can drive significant variation across batches, resulting in so-called batch effects.\n\nCuratedOvarianData has been preprocessed to adjust for batches defined by the study of origin using [Combat](https://www.bu.edu/jlab/wp-assets/ComBat/Download.html) [@Johnson2006]. Other batch effects may be present.\n\n[\\@Leek2010nrg](https://doi.org/10.1038/nrg2825) wrote a useful overview of batch effects.\n\n{{< pagebreak >}}\n\n## The CuratedOvarianData package\n\n### Background\n\nComprehensive review of predictors and datasets for signature validation [\\@Waldron2014](https://academic.oup.com/jnci/article-abstract/106/5/dju049/2606979)\n\n{{< pagebreak >}}\n\n### Preprocessing of Gene Expression Data in CuratedOvarianData\n\n![Scheme of preprocessing pipeline for the CuratedOvarianData Package](Figures/GanzfriedF1b.pdf)\n\nDetailed description of dataset [\\@ganzfried2013curatedovariandata](https://academic.oup.com/database/article-abstract/doi/10.1093/database/bat013/330978)\n\n{{< pagebreak >}}\n\n### Clinical Phenotypes in the CuratedOvarianData Package\n\n![This heatmap visualizes for each curated clinical characteristic (rows) the availability in each data set (columns). Red indicates that the corresponding characteristic is available for at least one sample in the data set. See [\\@ganzfried2013curatedovariandata](https://academic.oup.com/database/article-abstract/doi/10.1093/database/bat013/330978) for further details.](Figures/GanzfriedF2.pdf)\n\nIt may seem disappointing that there are only two clinical annotations that all of these datasets have. When we originally created the dataset we recontacted all the groups that originally generated the data to try to fill as many of the gaps as possible. Unfortunately some of the clinical data may not have been collected, or may not be easy to share due to privacy concerns or investigators' reluctance. Since we compiled this data, the field has moved towards larger coordinated efforts across multiple institutions, which have had better outcomes in terms of completeness and homogeneity of phenotypes. An example is [PCAWG](https://dcc.icgc.org/) but heterogeneity and missingness of labels remain important issues in health data.\n\n::: callout-important\n## Question for Debate\n\nHandling missing data is a prominent challenge, particularly in the context of clinical data collection. What data collection standards should be in place, and what are some effective methods for managing missingness (and more broadly, data quality) in these datasets?\n:::\n\n{{< pagebreak >}}\n\n### Loading the Package and Extracting Expression Data Matrices\n\nWe next load the CuratedOvarianData package and two datasets contained within. For now we will only consider the datasets `TCGA_eset` and `GSE32063_eset`. To check important characteristics of each of the studies, just enter the study ID (for example GSE32063) in the [Gene Expression Omnibus query page](https://www.ncbi.nlm.nih.gov/geo/)\n\n```{r, echo=T, message=F, warnings = F, cache=F}\nlibrary(curatedOvarianData)\n# data(package=\"curatedOvarianData\")\n# Above line would lists all datasets available within the package.\ndata(TCGA_eset)\ndata(GSE32063_eset)\n```\n\n{{< pagebreak >}}\n\n```{r, echo=T, message=F, warnings = F, cache=F}\nhead(exprs(TCGA_eset)[1:6,1:6])\nhead(exprs(GSE32063_eset)[1:6,1:6])\n```\n\n{{< pagebreak >}}\n\n### Basic Visualizations\n\nClustered heatmap of the top 100 most variable genes in the first 50 samples in TCGA. The expression scale is the log of the pre-processed intensities.\n\n```{r, echo=T, message=F, warnings = F, cache=F, fig.height=5, fig.width=10}\nsds = apply(exprs(TCGA_eset)[,1:50],1,sd)\nlibrary(gplots)\nheatmap.2((exprs(TCGA_eset)[,1:50])[order(sds,decreasing=TRUE)[1:20],],\n          margins = c(6, 10))\n```\n\nTrees (dendrograms) on the top and sides represent the result of hierarchical clustering. The goal is to reorder rows and columns so that similar rows (column) are close to each other. In this case I am using them to facilitate visualization, but this is also a technique to identify patterns in the data or divide them into subgroups. This is a general overview [\\@Garrett2005](https://biostats.bepress.com/jhubiostat/paper70/)\n\nThe heatmap.2 function calls hclust to produce the dendrograms. The procedure is agglomerative ---it starts by joining single rows, and proceeds iteratively from the bottom up. The lenth of the branches grows with the distance of the two entities (rows of clusters of rows) being joined. The default agglomeration method is the \"complete linkage\" method in which clusters are linked based on the similarity of the furthest members. Same for columns.\n\nBlue lines. Inside the legend: histogram frequencies; inside the heat map, the distance of the line from the center of each color-cell is proportional to the size of the measurement (overkill? depends, people perceive location differently from color so it could help). {{< pagebreak >}}\n\nDistribution of location (median) and scale (Interquartile Range, or IQR), by gene and by sample.\n\n```{r, echo=T, message=F, warnings = F, cache=F}\niqr.g = apply(exprs(TCGA_eset),1,IQR) #\nhist(iqr.g, main =\"IQR by gene\")\niqr.s = apply(exprs(TCGA_eset),2,IQR) \nhist(iqr.s, main =\"IQR by sample\")\nmed.g = apply(exprs(TCGA_eset),1,median)\nhist(med.g, main =\"median by gene\")\nmed.s = apply(exprs(TCGA_eset),2,median)\nhist(med.s, main =\"median by sample\")\n```\n\n::: callout-note\n### Quantile Normlization\n\nIf quantile normalization was applied by sample, why aren't all medians and all IQR's the same in the histograms by sample?\n\nAt least two reasons: 1) QN was applied at the proble level. Within each study data sere subsequently aggregated first by probeset and then by gene. 2) To (hopefully) increase comparabiity across studies, data where further process with a batch adjustment model that regresses out gene specific effects.\n:::\n\n{{< pagebreak >}}\n\nClustered heatmap of the top 100 most variable genes in the Yoshirara study. The technology is Agilent. [\\@yoshihara2012](https://doi.org/10.1158/1078-0432.CCR-11-2725) describes the preprocessing approach. This set of 40 patients is \"Dataset B\" in [@yoshihara2012].\n\n```{r, echo=T, message=F, warnings = F, cache=F, fig.height=5, fig.width=10}\nsds = apply(exprs(GSE32063_eset),1,sd)\nlibrary(gplots)\nheatmap.2(exprs(GSE32063_eset)[order(sds,decreasing=TRUE)[1:20],])\n```\n\n{{< pagebreak >}}\n\nDistribution of location (median) and scale (Interquartile Range, or IQR), by gene and by sample.\n\n```{r, echo=T, message=F, warnings = F, cache=F}\niqr.g = apply(exprs(GSE32063_eset),1,IQR)\nhist(iqr.g, main =\"IQR by gene\")\niqr.s = apply(exprs(GSE32063_eset),2,IQR) \nhist(iqr.s, main =\"IQR by sample\")\nmed.g = apply(exprs(GSE32063_eset),1,median)\nhist(med.g, main =\"median by gene\")\nmed.s = apply(exprs(GSE32063_eset),2,median)\nhist(med.s, main =\"median by sample\")\n```\n\n::: callout-important\n## Question for Debate\n\nA variety of data normalization are performed in RNA-Seq analysis. What are some of the different methods of normalization, and what is their impact on data interpretability?\n:::\n\n\n## References\n\n::: {#refs}\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"L3-data.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.545","bibliography":["references.bib"],"editor":"visual","theme":"cosmo","includes":{"in-header":{"lightbox":true}},"date":"January 30, 2024"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}
=======
{"title":"Lecture 3: Data","markdown":{"yaml":{"date":"January 31, 2023"},"headingText":"Lecture 3: Data","containsRefs":true,"markdown":"\n\n\n## High Throughput Gene Expression Measurement\n\n### Steps of Gene Expression Measurement\n\n-   Specimen Acquisition (get the samples, preserve them between the clinic and the lab, isolate the cells of interest etc)\n\n-   Extraction / Preparation Protocols (extract RNA from the samples, often do additional preparation to get it ready for analysis (e.g add tags); often convert RNA into complementary DNA, or cDNA; break sequences into tiny fragments to be reassembled later)\n\n-   Quantification (run the experiment)\n\n-   Raw Data (typically images)\n\n-   Your Data (a heavily preprocessed summary attempting to quantify expression at the aggregate level of a \"gene\")\n\n{{< pagebreak >}}\n\n### Affymetrix Microarrays (\"Affy\")\n\nWe will work with expression data after it has been preprocessed and summarized at the gene label level. We will analyze a lot of data from the Affy platform. Preprocessing is a statistically challenging step. Some of the most important issues for Affymetrix data are discussed by [\\@Owzar2008ccr](https://clincancerres.aacrjournals.org/content/clincanres/14/19/5959.full.pdf)\n\nI also highly recommend [Katerina Taskova's Introduction to Microarray Analysis](https://cbdm.uni-mainz.de/files/2016/02/GE_microarrays.pdf) slide deck.\n\n::: callout-note\n### Reading Notes\n\n-   RMA (slides 13-17) was used to preprocess the data we will use. A high-level understanding is useful. It produces summaries of expression at the level of the probe-set.\n\n-   It is useful to know the difference between a probe (a single 25-nucleotide sequence), a probe-set (a group of probes predicted to appear on the coding sequence of a gene) and a gene (a region of DNA believed to often be the source of information for the production of a particular set of related proteins).\n\n-   Multiple probe-sets can map the same gene (for a digression about this see [@stalteri2007bmcb]) To keep things simple and to cross-reference features across technologies we have averaged over these and will use data at the gene level [@ganzfried2013curatedovariandata].\n\n-   Think about quantile normalization (QN) when looking at Slide 19. Does QN help? Does it remove the artifact in bad.cel completely? Does it remove the \"fog\" in NEG10-1?\n\n-   We will cover differential expression later in the course (Slides 23-29). You are welcome to take a peek, but you can skip for now.\n\n-   Each of the bullets on Slide 30 embeds its own sources of both noise and systematic biases.\n:::\n\nMultiple probe sets for the same gene in Affy are sometimes designed to capture different isoforms (that is messenger RNAs made with different selection of exons). Because Affy needs to position probes near one end of the gene (long story), the extent to which they can capture different isoforms is not great compared to RNA-seq. But there could certainly be exceptions. Affy also used multiple probe sets to increase the number of probes dedicated to a certain genes, when the gene is important or there is uncertainty about mapping. In these cases averaging actually helps.\n\nRabbit hole: For those interested in a digression on imaging approaches (not covered at all in the class) including a menagerie of artifacts, see [\\@arteaga-salas2007bb](http://dx.doi.org/10.1093/bib/bbm055)\n\n{{< pagebreak >}}\n\n### RNA-seq\n\nRNA-seq is the current alternative to hybridization microarrays. There are several RNA-seq datasets in the CuratedOvarianCanceer and CuratedBreastCancer package you will use in this class, but RNA-seq data exploration will be mostly optional. The main statistical lessons for this course can be learned equally well from Affy data. Of course I would not say this about a Bioinformatics class.\n\nFor those interested in understanding RNA-seq a bit more, I recommend the sections \"Overview\" and \"Alignment and Quantification\" from [\\@VandenBerge2019arbds](https://doi.org/10.1146/annurev-biodatasci-072018-021255)\n\n[\\@Xu2013bmcb](https://doi.org/10.1186/1471-2105-14-S9-S1) report a head-to-head comparison of Affy and RNA-seq high throughput measurements. RNA-seq generates count data. It is interesting to look at [Figure 1](https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-S9-S1/figures/1) and think about how to interpret the \"stripes\" in panel B.\n\nMicroarrays are rarely used for discovery these days. Many of the statistical challenges of biomarker discovery, however, have remained the same. The advantage of using microarrays for this course is there there are far more studies readily available, so certain parts of the course still work a lot better with microarray than RNA-seq.\n\n{{< pagebreak >}}\n\n## Batch Effects\n\nHigh-throughput biology data are often produced in batches for efficiency or practical restrictions. Differences across how these batches are handled (in any of the bullets in Slide 30 of [Katerina Taskova's Introduction to Microarray Analysis](https://cbdm.uni-mainz.de/files/2016/02/GE_microarrays.pdf)), can drive significant variation across batches, resulting in so-called batch effects.\n\nCuratedOvarianData has been preprocessed to adjust for batches defined by the study of origin using [Combat](https://www.bu.edu/jlab/wp-assets/ComBat/Download.html) [@Johnson2006]. Other batch effects may be present.\n\n[\\@Leek2010nrg](https://doi.org/10.1038/nrg2825) wrote a useful overview of batch effects.\n\n{{< pagebreak >}}\n\n## The CuratedOvarianData package\n\n### Background\n\nComprehensive review of predictors and datasets for signature validation [\\@Waldron2014](https://academic.oup.com/jnci/article-abstract/106/5/dju049/2606979)\n\n{{< pagebreak >}}\n\n### Preprocessing of Gene Expression Data in CuratedOvarianData\n\n![Scheme of preprocessing pipeline for the CuratedOvarianData Package](Figures/GanzfriedF1b.pdf)\n\nDetailed description of dataset [\\@ganzfried2013curatedovariandata](https://academic.oup.com/database/article-abstract/doi/10.1093/database/bat013/330978)\n\n{{< pagebreak >}}\n\n### Clinical Phenotypes in the CuratedOvarianData Package\n\n![This heatmap visualizes for each curated clinical characteristic (rows) the availability in each data set (columns). Red indicates that the corresponding characteristic is available for at least one sample in the data set. See [\\@ganzfried2013curatedovariandata](https://academic.oup.com/database/article-abstract/doi/10.1093/database/bat013/330978) for further details.](Figures/GanzfriedF2.pdf)\n\nIt may seem disappointing that there are only two clinical annotations that all of these datasets have. When we originally created the dataset we recontacted all the groups that originally generated the data to try to fill as many of the gaps as possible. Unfortunately some of the clinical data may not have been collected, or may not be easy to share due to privacy concerns or investigators' reluctance. Since we compiled this data, the field has moved towards larger coordinated efforts across multiple institutions, which have had better outcomes in terms of completeness and homogeneity of phenotypes. An example is [PCAWG](https://dcc.icgc.org/) but heterogeneity and missingness of labels remain important issues in health data.\n\n{{< pagebreak >}}\n\n### Loading the Package and Extracting Expression Data Matrices\n\nWe next load the CuratedOvarianData package and two datasets contained within. For now we will only consider the datasets `TCGA_eset` and `GSE32063_eset`. To check important characteristics of each of the studies, just enter the study ID (for example GSE32063) in the [Gene Expression Omnibus query page](https://www.ncbi.nlm.nih.gov/geo/)\n\n```{r, echo=T, message=F, warnings = F, cache=F}\nlibrary(curatedOvarianData)\n# data(package=\"curatedOvarianData\")\n# Above line would lists all datasets available within the package.\ndata(TCGA_eset)\ndata(GSE32063_eset)\n```\n\n{{< pagebreak >}}\n\n```{r, echo=T, message=F, warnings = F, cache=F}\nhead(exprs(TCGA_eset)[1:6,1:6])\nhead(exprs(GSE32063_eset)[1:6,1:6])\n```\n\n{{< pagebreak >}}\n\n### Basic Visualizations\n\nClustered heatmap of the top 100 most variable genes in the first 50 samples in TCGA. The expression scale is the log of the pre-processed intensities.\n\n```{r, echo=T, message=F, warnings = F, cache=F, fig.height=5, fig.width=10}\nsds = apply(exprs(TCGA_eset)[,1:50],1,sd)\nlibrary(gplots)\nheatmap.2((exprs(TCGA_eset)[,1:50])[order(sds,decreasing=TRUE)[1:20],],\n          margins = c(6, 10))\n```\n\nTrees (dendrograms) on the top and sides represent the result of hierarchical clustering. The goal is to reorder rows and columns so that similar rows (column) are close to each other. In this case I am using them to facilitate visualization, but this is also a technique to identify patterns in the data or divide them into subgroups. This is a general overview [\\@Garrett2005](https://biostats.bepress.com/jhubiostat/paper70/)\n\nThe heatmap.2 function calls hclust to produce the dendrograms. The procedure is agglomerative ---it starts by joining single rows, and proceeds iteratively from the bottom up. The lenth of the branches grows with the distance of the two entities (rows of clusters of rows) being joined. The default agglomeration method is the \"complete linkage\" method in which clusters are linked based on the similarity of the furthest members. Same for columns.\n\nBlue lines. Inside the legend: histogram frequencies; inside the heat map, the distance of the line from the center of each color-cell is proportional to the size of the measurement (overkill? depends, people perceive location differently from color so it could help). {{< pagebreak >}}\n\nDistribution of location (median) and scale (Interquartile Range, or IQR), by gene and by sample.\n\n```{r, echo=T, message=F, warnings = F, cache=F}\niqr.g = apply(exprs(TCGA_eset),1,IQR) #\nhist(iqr.g, main =\"IQR by gene\")\niqr.s = apply(exprs(TCGA_eset),2,IQR) \nhist(iqr.s, main =\"IQR by sample\")\nmed.g = apply(exprs(TCGA_eset),1,median)\nhist(med.g, main =\"median by gene\")\nmed.s = apply(exprs(TCGA_eset),2,median)\nhist(med.s, main =\"median by sample\")\n```\n\n::: callout-note\n### Quantile Normlization\n\nIf quantile normalization was applied by sample, why aren't all medians and all IQR's the same in the histograms by sample?\n\nAt least two reasons: 1) QN was applied at the proble level. Within each study data sere subsequently aggregated first by probeset and then by gene. 2) To (hopefully) increase comparabiity across studies, data where further process with a batch adjustment model that regresses out gene specific effects.\n:::\n\n{{< pagebreak >}}\n\nClustered heatmap of the top 100 most variable genes in the Yoshirara study. The technology is Agilent. [\\@yoshihara2012](https://doi.org/10.1158/1078-0432.CCR-11-2725) describes the preprocessing approach. This set of 40 patients is \"Dataset B\" in [@yoshihara2012].\n\n```{r, echo=T, message=F, warnings = F, cache=F, fig.height=5, fig.width=10}\nsds = apply(exprs(GSE32063_eset),1,sd)\nlibrary(gplots)\nheatmap.2(exprs(GSE32063_eset)[order(sds,decreasing=TRUE)[1:20],])\n```\n\n{{< pagebreak >}}\n\nDistribution of location (median) and scale (Interquartile Range, or IQR), by gene and by sample.\n\n```{r, echo=T, message=F, warnings = F, cache=F}\niqr.g = apply(exprs(GSE32063_eset),1,IQR)\nhist(iqr.g, main =\"IQR by gene\")\niqr.s = apply(exprs(GSE32063_eset),2,IQR) \nhist(iqr.s, main =\"IQR by sample\")\nmed.g = apply(exprs(GSE32063_eset),1,median)\nhist(med.g, main =\"median by gene\")\nmed.s = apply(exprs(GSE32063_eset),2,median)\nhist(med.s, main =\"median by sample\")\n```\n\n\\newpage\n\n## References\n\n::: {#refs}\n:::\n","srcMarkdownNoYaml":"\n\n# Lecture 3: Data\n\n## High Throughput Gene Expression Measurement\n\n### Steps of Gene Expression Measurement\n\n-   Specimen Acquisition (get the samples, preserve them between the clinic and the lab, isolate the cells of interest etc)\n\n-   Extraction / Preparation Protocols (extract RNA from the samples, often do additional preparation to get it ready for analysis (e.g add tags); often convert RNA into complementary DNA, or cDNA; break sequences into tiny fragments to be reassembled later)\n\n-   Quantification (run the experiment)\n\n-   Raw Data (typically images)\n\n-   Your Data (a heavily preprocessed summary attempting to quantify expression at the aggregate level of a \"gene\")\n\n{{< pagebreak >}}\n\n### Affymetrix Microarrays (\"Affy\")\n\nWe will work with expression data after it has been preprocessed and summarized at the gene label level. We will analyze a lot of data from the Affy platform. Preprocessing is a statistically challenging step. Some of the most important issues for Affymetrix data are discussed by [\\@Owzar2008ccr](https://clincancerres.aacrjournals.org/content/clincanres/14/19/5959.full.pdf)\n\nI also highly recommend [Katerina Taskova's Introduction to Microarray Analysis](https://cbdm.uni-mainz.de/files/2016/02/GE_microarrays.pdf) slide deck.\n\n::: callout-note\n### Reading Notes\n\n-   RMA (slides 13-17) was used to preprocess the data we will use. A high-level understanding is useful. It produces summaries of expression at the level of the probe-set.\n\n-   It is useful to know the difference between a probe (a single 25-nucleotide sequence), a probe-set (a group of probes predicted to appear on the coding sequence of a gene) and a gene (a region of DNA believed to often be the source of information for the production of a particular set of related proteins).\n\n-   Multiple probe-sets can map the same gene (for a digression about this see [@stalteri2007bmcb]) To keep things simple and to cross-reference features across technologies we have averaged over these and will use data at the gene level [@ganzfried2013curatedovariandata].\n\n-   Think about quantile normalization (QN) when looking at Slide 19. Does QN help? Does it remove the artifact in bad.cel completely? Does it remove the \"fog\" in NEG10-1?\n\n-   We will cover differential expression later in the course (Slides 23-29). You are welcome to take a peek, but you can skip for now.\n\n-   Each of the bullets on Slide 30 embeds its own sources of both noise and systematic biases.\n:::\n\nMultiple probe sets for the same gene in Affy are sometimes designed to capture different isoforms (that is messenger RNAs made with different selection of exons). Because Affy needs to position probes near one end of the gene (long story), the extent to which they can capture different isoforms is not great compared to RNA-seq. But there could certainly be exceptions. Affy also used multiple probe sets to increase the number of probes dedicated to a certain genes, when the gene is important or there is uncertainty about mapping. In these cases averaging actually helps.\n\nRabbit hole: For those interested in a digression on imaging approaches (not covered at all in the class) including a menagerie of artifacts, see [\\@arteaga-salas2007bb](http://dx.doi.org/10.1093/bib/bbm055)\n\n{{< pagebreak >}}\n\n### RNA-seq\n\nRNA-seq is the current alternative to hybridization microarrays. There are several RNA-seq datasets in the CuratedOvarianCanceer and CuratedBreastCancer package you will use in this class, but RNA-seq data exploration will be mostly optional. The main statistical lessons for this course can be learned equally well from Affy data. Of course I would not say this about a Bioinformatics class.\n\nFor those interested in understanding RNA-seq a bit more, I recommend the sections \"Overview\" and \"Alignment and Quantification\" from [\\@VandenBerge2019arbds](https://doi.org/10.1146/annurev-biodatasci-072018-021255)\n\n[\\@Xu2013bmcb](https://doi.org/10.1186/1471-2105-14-S9-S1) report a head-to-head comparison of Affy and RNA-seq high throughput measurements. RNA-seq generates count data. It is interesting to look at [Figure 1](https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-S9-S1/figures/1) and think about how to interpret the \"stripes\" in panel B.\n\nMicroarrays are rarely used for discovery these days. Many of the statistical challenges of biomarker discovery, however, have remained the same. The advantage of using microarrays for this course is there there are far more studies readily available, so certain parts of the course still work a lot better with microarray than RNA-seq.\n\n{{< pagebreak >}}\n\n## Batch Effects\n\nHigh-throughput biology data are often produced in batches for efficiency or practical restrictions. Differences across how these batches are handled (in any of the bullets in Slide 30 of [Katerina Taskova's Introduction to Microarray Analysis](https://cbdm.uni-mainz.de/files/2016/02/GE_microarrays.pdf)), can drive significant variation across batches, resulting in so-called batch effects.\n\nCuratedOvarianData has been preprocessed to adjust for batches defined by the study of origin using [Combat](https://www.bu.edu/jlab/wp-assets/ComBat/Download.html) [@Johnson2006]. Other batch effects may be present.\n\n[\\@Leek2010nrg](https://doi.org/10.1038/nrg2825) wrote a useful overview of batch effects.\n\n{{< pagebreak >}}\n\n## The CuratedOvarianData package\n\n### Background\n\nComprehensive review of predictors and datasets for signature validation [\\@Waldron2014](https://academic.oup.com/jnci/article-abstract/106/5/dju049/2606979)\n\n{{< pagebreak >}}\n\n### Preprocessing of Gene Expression Data in CuratedOvarianData\n\n![Scheme of preprocessing pipeline for the CuratedOvarianData Package](Figures/GanzfriedF1b.pdf)\n\nDetailed description of dataset [\\@ganzfried2013curatedovariandata](https://academic.oup.com/database/article-abstract/doi/10.1093/database/bat013/330978)\n\n{{< pagebreak >}}\n\n### Clinical Phenotypes in the CuratedOvarianData Package\n\n![This heatmap visualizes for each curated clinical characteristic (rows) the availability in each data set (columns). Red indicates that the corresponding characteristic is available for at least one sample in the data set. See [\\@ganzfried2013curatedovariandata](https://academic.oup.com/database/article-abstract/doi/10.1093/database/bat013/330978) for further details.](Figures/GanzfriedF2.pdf)\n\nIt may seem disappointing that there are only two clinical annotations that all of these datasets have. When we originally created the dataset we recontacted all the groups that originally generated the data to try to fill as many of the gaps as possible. Unfortunately some of the clinical data may not have been collected, or may not be easy to share due to privacy concerns or investigators' reluctance. Since we compiled this data, the field has moved towards larger coordinated efforts across multiple institutions, which have had better outcomes in terms of completeness and homogeneity of phenotypes. An example is [PCAWG](https://dcc.icgc.org/) but heterogeneity and missingness of labels remain important issues in health data.\n\n{{< pagebreak >}}\n\n### Loading the Package and Extracting Expression Data Matrices\n\nWe next load the CuratedOvarianData package and two datasets contained within. For now we will only consider the datasets `TCGA_eset` and `GSE32063_eset`. To check important characteristics of each of the studies, just enter the study ID (for example GSE32063) in the [Gene Expression Omnibus query page](https://www.ncbi.nlm.nih.gov/geo/)\n\n```{r, echo=T, message=F, warnings = F, cache=F}\nlibrary(curatedOvarianData)\n# data(package=\"curatedOvarianData\")\n# Above line would lists all datasets available within the package.\ndata(TCGA_eset)\ndata(GSE32063_eset)\n```\n\n{{< pagebreak >}}\n\n```{r, echo=T, message=F, warnings = F, cache=F}\nhead(exprs(TCGA_eset)[1:6,1:6])\nhead(exprs(GSE32063_eset)[1:6,1:6])\n```\n\n{{< pagebreak >}}\n\n### Basic Visualizations\n\nClustered heatmap of the top 100 most variable genes in the first 50 samples in TCGA. The expression scale is the log of the pre-processed intensities.\n\n```{r, echo=T, message=F, warnings = F, cache=F, fig.height=5, fig.width=10}\nsds = apply(exprs(TCGA_eset)[,1:50],1,sd)\nlibrary(gplots)\nheatmap.2((exprs(TCGA_eset)[,1:50])[order(sds,decreasing=TRUE)[1:20],],\n          margins = c(6, 10))\n```\n\nTrees (dendrograms) on the top and sides represent the result of hierarchical clustering. The goal is to reorder rows and columns so that similar rows (column) are close to each other. In this case I am using them to facilitate visualization, but this is also a technique to identify patterns in the data or divide them into subgroups. This is a general overview [\\@Garrett2005](https://biostats.bepress.com/jhubiostat/paper70/)\n\nThe heatmap.2 function calls hclust to produce the dendrograms. The procedure is agglomerative ---it starts by joining single rows, and proceeds iteratively from the bottom up. The lenth of the branches grows with the distance of the two entities (rows of clusters of rows) being joined. The default agglomeration method is the \"complete linkage\" method in which clusters are linked based on the similarity of the furthest members. Same for columns.\n\nBlue lines. Inside the legend: histogram frequencies; inside the heat map, the distance of the line from the center of each color-cell is proportional to the size of the measurement (overkill? depends, people perceive location differently from color so it could help). {{< pagebreak >}}\n\nDistribution of location (median) and scale (Interquartile Range, or IQR), by gene and by sample.\n\n```{r, echo=T, message=F, warnings = F, cache=F}\niqr.g = apply(exprs(TCGA_eset),1,IQR) #\nhist(iqr.g, main =\"IQR by gene\")\niqr.s = apply(exprs(TCGA_eset),2,IQR) \nhist(iqr.s, main =\"IQR by sample\")\nmed.g = apply(exprs(TCGA_eset),1,median)\nhist(med.g, main =\"median by gene\")\nmed.s = apply(exprs(TCGA_eset),2,median)\nhist(med.s, main =\"median by sample\")\n```\n\n::: callout-note\n### Quantile Normlization\n\nIf quantile normalization was applied by sample, why aren't all medians and all IQR's the same in the histograms by sample?\n\nAt least two reasons: 1) QN was applied at the proble level. Within each study data sere subsequently aggregated first by probeset and then by gene. 2) To (hopefully) increase comparabiity across studies, data where further process with a batch adjustment model that regresses out gene specific effects.\n:::\n\n{{< pagebreak >}}\n\nClustered heatmap of the top 100 most variable genes in the Yoshirara study. The technology is Agilent. [\\@yoshihara2012](https://doi.org/10.1158/1078-0432.CCR-11-2725) describes the preprocessing approach. This set of 40 patients is \"Dataset B\" in [@yoshihara2012].\n\n```{r, echo=T, message=F, warnings = F, cache=F, fig.height=5, fig.width=10}\nsds = apply(exprs(GSE32063_eset),1,sd)\nlibrary(gplots)\nheatmap.2(exprs(GSE32063_eset)[order(sds,decreasing=TRUE)[1:20],])\n```\n\n{{< pagebreak >}}\n\nDistribution of location (median) and scale (Interquartile Range, or IQR), by gene and by sample.\n\n```{r, echo=T, message=F, warnings = F, cache=F}\niqr.g = apply(exprs(GSE32063_eset),1,IQR)\nhist(iqr.g, main =\"IQR by gene\")\niqr.s = apply(exprs(GSE32063_eset),2,IQR) \nhist(iqr.s, main =\"IQR by sample\")\nmed.g = apply(exprs(GSE32063_eset),1,median)\nhist(med.g, main =\"median by gene\")\nmed.s = apply(exprs(GSE32063_eset),2,median)\nhist(med.s, main =\"median by sample\")\n```\n\n\\newpage\n\n## References\n\n::: {#refs}\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"L3-data.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.545","editor":"visual","theme":"cosmo","date":"January 31, 2023"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}
>>>>>>> 92c20afe76ab07d31ab0497a205dfd81dae5acec
